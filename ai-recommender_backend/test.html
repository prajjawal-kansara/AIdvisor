<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tool Discovery Platform</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .loading-dots {
            display: inline-block;
        }
        .loading-dots:after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }
        .tool-card {
            transition: all 0.3s ease;
            transform: translateY(0);
        }
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .rating-stars {
            color: #fbbf24;
        }
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // API Configuration
        const API_BASE_URL = 'http://localhost:3000';

        // Main App Component
        function App() {
            const [userPrompt, setUserPrompt] = useState('');
            const [recommendations, setRecommendations] = useState(null);
            const [insights, setInsights] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [activeTab, setActiveTab] = useState('recommend');

            // Test server connection on mount
            useEffect(() => {
                testConnection();
            }, []);

            const testConnection = async () => {
                try {
                    const response = await fetch(`${API_BASE_URL}/health`);
                    const data = await response.json();
                    console.log('Server connected:', data);
                } catch (error) {
                    console.error('Server connection failed:', error);
                    setError('Backend server is not running. Please start the server on port 3000.');
                }
            };

            const fetchInsights = async () => {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/insights`);
                    const data = await response.json();
                    if (data.success) {
                        setInsights(data.insights);
                    }
                } catch (error) {
                    console.error('Error fetching insights:', error);
                }
            };

            const handleRecommendation = async (e) => {
                e.preventDefault();
                if (!userPrompt.trim()) return;

                setLoading(true);
                setError('');
                setRecommendations(null);

                try {
                    const response = await fetch(`${API_BASE_URL}/api/recommend`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ userPrompt })
                    });

                    const data = await response.json();
                    
                    if (data.success) {
                        setRecommendations(data);
                    } else {
                        setError(data.error || 'Failed to get recommendations');
                    }
                } catch (error) {
                    setError('Network error. Make sure your backend is running on port 3000.');
                    console.error('Error:', error);
                } finally {
                    setLoading(false);
                }
            };

            const renderStars = (rating) => {
                const stars = [];
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 !== 0;

                for (let i = 0; i < 5; i++) {
                    if (i < fullStars) {
                        stars.push(<i key={i} className="fas fa-star rating-stars"></i>);
                    } else if (i === fullStars && hasHalfStar) {
                        stars.push(<i key={i} className="fas fa-star-half-alt rating-stars"></i>);
                    } else {
                        stars.push(<i key={i} className="far fa-star rating-stars"></i>);
                    }
                }
                return stars;
            };

            const samplePrompts = [
                "I need an AI tool to create marketing images for my startup",
                "Looking for an AI assistant to help with coding and debugging",
                "I want to automate my business workflows and save time",
                "Need AI for creating professional voiceovers for videos",
                "Looking for AI to help write blog posts and marketing content",
                "I need to analyze large datasets and generate insights",
                "Want to create chatbots for customer service",
                "Need AI for video editing and content creation"
            ];

            return (
                <div className="min-h-screen p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <h1 className="text-4xl md:text-6xl font-bold text-white mb-4">
                                AI Tool <span className="gradient-text">Discovery</span>
                            </h1>
                            <p className="text-xl text-white/80 max-w-3xl mx-auto">
                                Powered by Gemini AI â€¢ Discover tools from the entire AI ecosystem
                            </p>
                        </div>

                        {/* Navigation Tabs */}
                        <div className="glass rounded-2xl p-1 mb-8 max-w-lg mx-auto">
                            <div className="flex">
                                <button
                                    onClick={() => setActiveTab('recommend')}
                                    className={`flex-1 py-3 px-6 rounded-xl font-semibold transition-all ${
                                        activeTab === 'recommend' 
                                            ? 'bg-white text-purple-600 shadow-lg' 
                                            : 'text-white hover:bg-white/10'
                                    }`}
                                >
                                    <i className="fas fa-magic mr-2"></i>
                                    Recommendations
                                </button>
                                <button
                                    onClick={() => {
                                        setActiveTab('insights');
                                        if (!insights) fetchInsights();
                                    }}
                                    className={`flex-1 py-3 px-6 rounded-xl font-semibold transition-all ${
                                        activeTab === 'insights' 
                                            ? 'bg-white text-purple-600 shadow-lg' 
                                            : 'text-white hover:bg-white/10'
                                    }`}
                                >
                                    <i className="fas fa-chart-line mr-2"></i>
                                    Insights
                                </button>
                            </div>
                        </div>

                        {/* Recommendation Tab */}
                        {activeTab === 'recommend' && (
                            <div className="space-y-8">
                                {/* Input Form */}
                                <div className="glass rounded-2xl p-8 fade-in">
                                    <form onSubmit={handleRecommendation} className="space-y-6">
                                        <div>
                                            <label className="block text-white font-semibold mb-3 text-lg">
                                                <i className="fas fa-comment-dots mr-2"></i>
                                                What do you need AI for?
                                            </label>
                                            <textarea
                                                value={userPrompt}
                                                onChange={(e) => setUserPrompt(e.target.value)}
                                                placeholder="Describe your needs in detail... e.g., 'I need to create marketing images for my e-commerce store with automated background removal and text overlay features'"
                                                className="w-full p-4 rounded-xl border-0 bg-white/90 placeholder-gray-500 text-gray-800 text-lg resize-none focus:ring-2 focus:ring-purple-500 focus:outline-none"
                                                rows="4"
                                            />
                                        </div>

                                        {/* Sample Prompts */}
                                        <div>
                                            <p className="text-white/80 mb-3">Or try these examples:</p>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                                                {samplePrompts.map((prompt, index) => (
                                                    <button
                                                        key={index}
                                                        type="button"
                                                        onClick={() => setUserPrompt(prompt)}
                                                        className="px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all text-sm text-left"
                                                    >
                                                        {prompt}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>

                                        <button
                                            type="submit"
                                            disabled={loading || !userPrompt.trim()}
                                            className="w-full py-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold text-lg rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
                                        >
                                            {loading ? (
                                                <>
                                                    <i className="fas fa-spinner fa-spin mr-2"></i>
                                                    Discovering AI Tools<span className="loading-dots"></span>
                                                </>
                                            ) : (
                                                <>
                                                    <i className="fas fa-search mr-2"></i>
                                                    Discover AI Tools
                                                </>
                                            )}
                                        </button>
                                    </form>
                                </div>

                                {/* Error Display */}
                                {error && (
                                    <div className="glass rounded-2xl p-6 border border-red-300 fade-in">
                                        <div className="flex items-start text-red-100">
                                            <i className="fas fa-exclamation-triangle mr-3 text-xl mt-1"></i>
                                            <div>
                                                <h3 className="font-semibold text-lg">Connection Error</h3>
                                                <p className="mt-2">{error}</p>
                                                <p className="mt-2 text-sm">Make sure your Node.js server is running on localhost:3000</p>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Recommendations Display */}
                                {recommendations && (
                                    <div className="space-y-8 fade-in">
                                        {/* User Intent Analysis */}
                                        {recommendations.userIntent && (
                                            <div className="glass rounded-2xl p-6">
                                                <h2 className="text-2xl font-bold text-white mb-4">
                                                    <i className="fas fa-bullseye mr-2"></i>
                                                    Analysis
                                                </h2>
                                                <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                                                    <div>
                                                        <h4 className="text-purple-200 font-semibold mb-2">Problem</h4>
                                                        <p className="text-white/90">{recommendations.userIntent.problem}</p>
                                                    </div>
                                                    <div>
                                                        <h4 className="text-purple-200 font-semibold mb-2">Category</h4>
                                                        <span className="px-3 py-1 bg-purple-500/30 text-purple-100 rounded-full text-sm">
                                                            {recommendations.userIntent.category}
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <h4 className="text-purple-200 font-semibold mb-2">Tech Level</h4>
                                                        <span className="px-3 py-1 bg-blue-500/30 text-blue-100 rounded-full text-sm">
                                                            {recommendations.userIntent.techLevel}
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <h4 className="text-purple-200 font-semibold mb-2">Budget</h4>
                                                        <span className="px-3 py-1 bg-green-500/30 text-green-100 rounded-full text-sm">
                                                            {recommendations.userIntent.budget}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                        {/* Summary */}
                                        <div className="glass rounded-2xl p-6">
                                            <h2 className="text-2xl font-bold text-white mb-4">
                                                <i className="fas fa-lightbulb mr-2"></i>
                                                Summary
                                            </h2>
                                            <p className="text-white/90 text-lg leading-relaxed">{recommendations.summary}</p>
                                        </div>

                                        {/* Recommended Tools */}
                                        <div>
                                            <h2 className="text-2xl font-bold text-white mb-6">
                                                <i className="fas fa-star mr-2"></i>
                                                Recommended AI Tools ({recommendations.recommendations?.length || 0})
                                            </h2>
                                            <div className="grid gap-6 lg:grid-cols-2 xl:grid-cols-3">
                                                {recommendations.recommendations?.map((tool, index) => (
                                                    <div key={index} className="glass rounded-2xl p-6 tool-card">
                                                        <div className="flex items-start justify-between mb-4">
                                                            <div className="flex-1">
                                                                <h3 className="text-xl font-bold text-white mb-1">
                                                                    {tool.name}
                                                                </h3>
                                                                <p className="text-purple-200 text-sm mb-2">
                                                                    by {tool.vendor}
                                                                </p>
                                                                {tool.website && (
                                                                    <a 
                                                                        href={tool.website} 
                                                                        target="_blank" 
                                                                        rel="noopener noreferrer"
                                                                        className="text-blue-300 hover:text-blue-200 text-sm"
                                                                    >
                                                                        <i className="fas fa-external-link-alt mr-1"></i>
                                                                        Visit Website
                                                                    </a>
                                                                )}
                                                            </div>
                                                            <div className="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                                                                {tool.matchScore}% Match
                                                            </div>
                                                        </div>

                                                        {/* Rating */}
                                                        {tool.rating && (
                                                            <div className="flex items-center mb-3">
                                                                <div className="flex mr-2">
                                                                    {renderStars(tool.rating)}
                                                                </div>
                                                                <span className="text-white/80 text-sm">
                                                                    {tool.rating} {tool.reviewsCount && `(${tool.reviewsCount.toLocaleString()} reviews)`}
                                                                </span>
                                                            </div>
                                                        )}

                                                        <p className="text-white/90 mb-4 text-sm leading-relaxed">
                                                            {tool.description}
                                                        </p>

                                                        {/* Categories */}
                                                        <div className="flex flex-wrap gap-1 mb-4">
                                                            {tool.categories?.slice(0, 3).map((cat, i) => (
                                                                <span key={i} className="px-2 py-1 bg-purple-500/30 text-purple-100 text-xs rounded-full">
                                                                    {cat}
                                                                </span>
                                                            ))}
                                                        </div>

                                                        {/* Pricing */}
                                                        <div className="flex items-center justify-between mb-4">
                                                            <div className="text-white/90">
                                                                {tool.pricing?.startingPrice ? (
                                                                    <span className="text-lg font-semibold">
                                                                        ${tool.pricing.startingPrice}
                                                                        <span className="text-sm text-white/70">/{tool.pricing.pricingModel}</span>
                                                                    </span>
                                                                ) : (
                                                                    <span className="text-lg font-semibold">Free</span>
                                                                )}
                                                                {tool.pricing?.hasFreeTier && (
                                                                    <span className="ml-2 px-2 py-1 bg-green-500/30 text-green-100 text-xs rounded-full">
                                                                        Free Tier
                                                                    </span>
                                                                )}
                                                            </div>
                                                            {tool.apiAvailable && (
                                                                <span className="px-2 py-1 bg-blue-500/30 text-blue-100 text-xs rounded-full">
                                                                    API Available
                                                                </span>
                                                            )}
                                                        </div>

                                                        {/* Key Features */}
                                                        {tool.features && (
                                                            <div className="mb-4">
                                                                <h4 className="text-white font-semibold mb-2">Key Features</h4>
                                                                <div className="text-white/80 text-sm space-y-1">
                                                                    {tool.features.slice(0, 3).map((feature, i) => (
                                                                        <div key={i} className="flex items-center">
                                                                            <i className="fas fa-check text-green-400 mr-2 text-xs"></i>
                                                                            {feature}
                                                                        </div>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                        )}

                                                        {/* Pros */}
                                                        {tool.pros && (
                                                            <div className="mb-4">
                                                                <h4 className="text-white font-semibold mb-2">Advantages</h4>
                                                                <div className="text-white/80 text-sm space-y-1">
                                                                    {tool.pros.slice(0, 2).map((pro, i) => (
                                                                        <div key={i} className="flex items-center">
                                                                            <i className="fas fa-plus text-green-400 mr-2 text-xs"></i>
                                                                            {pro}
                                                                        </div>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                        )}

                                                        {/* Reasoning */}
                                                        <div className="border-t border-white/20 pt-4">
                                                            <h4 className="text-white font-semibold mb-2">Why this tool?</h4>
                                                            <p className="text-white/80 text-sm">{tool.reasoning}</p>
                                                            {tool.bestFor && (
                                                                <p className="text-purple-200 text-sm mt-2">
                                                                    <i className="fas fa-star mr-1"></i>
                                                                    Best for: {tool.bestFor}
                                                                </p>
                                                            )}
                                                        </div>

                                                        {/* Getting Started */}
                                                        {tool.gettingStarted && (
                                                            <div className="mt-4 pt-4 border-t border-white/20">
                                                                <h4 className="text-white font-semibold mb-2">Getting Started</h4>
                                                                <p className="text-white/80 text-sm">{tool.gettingStarted}</p>
                                                            </div>
                                                        )}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>

                                        {/* Implementation Strategy */}
                                        {recommendations.implementationStrategy && (
                                            <div className="glass rounded-2xl p-6">
                                                <h3 className="text-xl font-bold text-white mb-4">
                                                    <i className="fas fa-route mr-2"></i>
                                                    Implementation Strategy
                                                </h3>
                                                <p className="text-white/90">{recommendations.implementationStrategy}</p>
                                            </div>
                                        )}

                                        {/* Budget Breakdown */}
                                        {recommendations.budgetBreakdown && (
                                            <div className="glass rounded-2xl p-6">
                                                <h3 className="text-xl font-bold text-white mb-4">
                                                    <i className="fas fa-dollar-sign mr-2"></i>
                                                    Budget Analysis
                                                </h3>
                                                <p className="text-white/90">{recommendations.budgetBreakdown}</p>
                                            </div>
                                        )}

                                        {/* Processing Info */}
                                        {recommendations.metadata && (
                                            <div className="glass rounded-2xl p-4">
                                                <div className="flex items-center justify-between text-white/70 text-sm">
                                                    <span>
                                                        <i className="fas fa-clock mr-1"></i>
                                                        Processed in {recommendations.metadata.processingTimeMs}ms
                                                    </span>
                                                    <span>
                                                        <i className="fas fa-robot mr-1"></i>
                                                        Powered by Gemini AI
                                                    </span>
                                                    <span>
                                                        <i className="fas fa-tools mr-1"></i>
                                                        {recommendations.metadata.totalRecommendations} tools found
                                                    </span>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Insights Tab */}
                        {activeTab === 'insights' && (
                            <div className="space-y-8">
                                {insights ? (
                                    <div className="space-y-6 fade-in">
                                        {/* Market Overview */}
                                        <div className="glass rounded-2xl p-6">
                                            <h2 className="text-2xl font-bold text-white mb-6">
                                                <i className="fas fa-chart-pie mr-2"></i>
                                                Market Overview
                                            </h2>
                                            <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                                                <div className="text-center">
                                                    <div className="text-3xl font-bold text-white mb-2">
                                                        {insights.marketOverview?.totalTools || 'N/A'}
                                                    </div>
                                                    <div className="text-purple-200">Total Tools</div>
                                                </div>
                                                <div className="text-center">
                                                    <div className="text-3xl font-bold text-white mb-2">
                                                        {insights.marketOverview?.marketValue || 'N/A'}
                                                    </div>
                                                    <div className="text-purple-200">Market Size</div>
                                                </div>
                                                <div className="text-center">
                                                    <div className="text-3xl font-bold text-white mb-2">
                                                        {insights.marketOverview?.growthRate || 'N/A'}
                                                    </div>
                                                    <div className="text-purple-200">Growth Rate</div>
                                                </div>
                                                <div className="text-center">
                                                    <div className="text-3xl font-bold text-white mb-2">
                                                        {insights.marketOverview?.keyPlayers?.length || 0}
                                                    </div>
                                                    <div className="text-purple-200">Key Players</div>
                                                </div>
                                            </div>
                                        </div>

                                        {/* Trending Categories */}
                                        {insights.trendingCategories && (
                                            <div className="glass rounded-2xl p-6">
                                                <h3 className="text-xl font-bold text-white mb-4">
                                                    <i className="fas fa-fire mr-2"></i>
                                                    Trending Categories
                                                </h3>
                                                <div className="grid md:grid-cols-2 gap-4">
                                                    {insights.trendingCategories.map((category, index) => (
                                                        <div key={index} className="bg-white/10 rounded-xl p-4">
                                                            <div className="flex justify-between items-start mb-2">
                                                                <h4 className="font-semibold text-white">{category.category}</h4>
                                                                <span className="px-2 py-1 bg-green-500/30 text-green-100 text-xs rounded-full">
                                                                    {category.growth}
                                                                </span>
                                                            </div>
                                                            <p className="text-white/80 text-sm">{category.description}</p>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {/* Emerging Tools */}
                                        {insights.emergingTools && (
                                            <div className="glass rounded-2xl p-6">
                                                <h3 className="text-xl font-bold text-white mb-4">
                                                    <i className="fas fa-seedling mr-2"></i>
                                                    Emerging Tools
                                                </h3>
                                                <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                                                    {insights.emergingTools.map((tool, index) => (
                                                        <div key={index} className="bg-white/10 rounded-xl p-4">
                                                            <h4 className="font-semibold text-white mb-1">{tool.name}</h4>
                                                            <span className="px-2 py-1 bg-purple-500/30 text-purple-100 text-xs rounded-full mb-2 inline-block">
                                                                {tool.category}
                                                            </span>
                                                            <p className="text-white/80 text-sm">{tool.whyTrending}</p>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {/* Future Outlook */}
                                        {insights.futureOutlook && (
                                            <div className="glass rounded-2xl p-6">
                                                <h3 className="text-xl font-bold text-white mb-4">
                                                    <i className="fas fa-crystal-ball mr-2"></i>
                                                    Future Outlook
                                                </h3>
                                                <p className="text-white/90 leading-relaxed">{insights.futureOutlook}</p>
                                            </div>
                                        )}
                                    </div>
                                ) : (
                                    <div className="glass rounded-2xl p-8 text-center">
                                        <i className="fas fa-spinner fa-spin text-white text-3xl mb-4"></i>
                                        <p className="text-white text-lg">Loading AI industry insights...</p>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>